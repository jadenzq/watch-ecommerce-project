<!DOCTYPE html>
<html xmlns="https://www.thymeleaf.org" lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Product Review</title>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" 
				integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" 
				crossorigin="anonymous">
		<link rel="stylesheet" href="/css/review.css">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Baskervville+SC&family=Noto+Sans+SC:wght@100..900&family=Rubik:ital,wght@0,500;1,500&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
	</head>	
	
	<body>
		<div th:replace="header"></div>
		<div class="container mt-5 mb-5 pb-3" id="review-container">
			<div class="row">
				<h1 class="bold-text pl-4 pt-4 pb-2">Product Review</h1>
			</div>
			<div class="row" id="average-rating">
				<div class="pl-3 pt-2">
					<div th:if="${#lists.size(reviews) == 0}">
						<h3 class="zcool-xiaowei-regular large-font ml-1">No rating yet</h3>
						<p class="zcool-xiaowei-regular ml-1 review-number">Be the first one who is rating here !</p>
					</div>
					<div th:if="${#lists.size(reviews) > 0}" class="d-flex mt-4">
						<h3 class="zcool-xiaowei-regular large-font ml-2" th:text="${averageRating} + '/5'"></h3>
						<i class="material-icons text-warning ml-2" id="review-star">
							<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-star-fill star-icon" viewBox="0 0 16 16">
						  		<path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
							</svg>
						</i>
					</div>
					<p th:if="${#lists.size(reviews) > 0}" class="zcool-xiaowei-regular review-number mb-4 ml-2" th:text="${#lists.size(reviews)} + ' reviews'"></p>
				</div>
			</div>
			<table class="table blue mt-3">
				<tbody>
					<tr th:each="review: ${reviews}">
						<td id="review-table">
							<!--loginID!-->
							<div class="d-inline-flex">
							    <p th:each="star : ${#numbers.sequence(1, review.rating)}" class="material-icons text-warning" style="display: inline-block; margin: 0;">
							        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-star-fill star-icon filled" viewBox="0 0 16 16">
							            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
							        </svg>
							    </p>
							    <div th:if="${review.rating < 5}">
							        <p th:each="star : ${#numbers.sequence(review.rating + 1, 5)}" style="display: inline-block; margin: 0;">
							            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-star-fill star-icon filled" viewBox="0 0 16 16">
							                <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
							            </svg>
							        </p>
							    </div>
							</div>
							<br>

							<span class="review-date" th:text="${#temporals.format(review.reviewDatetime, 'dd-MM-yyyy hh:mm')}"></span>
							<br>
						
							<span th:text="${review.reviewContent}"></span>
						</td>
					</tr>
				</tbody>
			</table>
			
			<form th:object="${review}" method="POST" id="review-section" class="pl-4 pr-4 pt-3 pb-3 mb-3">
				<h3 class="mid-font row star-rating-container">Give a review</h3>
				<div class="star-rating-container mb-2">
					<div class="star-rating">
		                <input required type="radio" th:field="*{rating}" id="star5" name="rating" th:value="5">
						<label for="star5">
							<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-star-fill star-icon filled ml-3" viewBox="0 0 16 16">
					            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
					        </svg>
						</label>
		                <input required type="radio" th:field="*{rating}" id="star4" name="rating" th:value="4"/>
						<label for="star4">
							<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-star-fill star-icon filled ml-3" viewBox="0 0 16 16">
					            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
					        </svg>
						</label>
		                <input required type="radio" th:field="*{rating}" id="star3" name="rating" th:value="3"/>
						<label for="star3">
							<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-star-fill star-icon filled ml-3" viewBox="0 0 16 16">
					            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
					        </svg>
						</label>
		                <input required type="radio" th:field="*{rating}" id="star2" name="rating" th:value="2"/>
						<label for="star2">
							<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-star-fill star-icon filled ml-3	" viewBox="0 0 16 16">
					            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
					        </svg>
						</label>
		                <input required type="radio" th:field="*{rating}" id="star1" name="rating" th:value="1"/>
						<label for="star1">
							<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-star-fill star-icon filled" viewBox="0 0 16 16">
					            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
					        </svg>
						</label>
		            </div>
				</div>
				<div>
					<textarea 				
						type="text"
						name="reviewContent"
						th:field="*{reviewContent}"
						class="form-control"
						rows="8"
						placeholder="What do you think of this product? (optional)" 
					>
					</textarea>
				</div>
				
				<input type="hidden" class="form-control" name="reviewDatetime" th:field="*{reviewDatetime}" th:value="${reviewDate}">
				
				<div class = "box-footer">
					<button type="submit" class="btn noto-sans-sc mt-3 mb-2" id="review-button" onclick="validateForm()">Submit</button>
				</div>
			</form>
			
			<script>
			    function validateForm() {
					var form = document.querySelector('input');
			        var selectedRating = document.querySelector('input[name="rating"]:checked');
			        if (selectedRating == null) {
			            alert("Please provide product's' rating");
			        }
			    }
			</script>
			
		</div>
		
		<div th:replace="footer"></div>
	</body>

</html>